!function(a,o,t,i){function e(t,i){var e,n,r=a(t),s=r.children(".panzoom"),l=s.children("svg"),p=r.children(".map__controls"),c=p.children(".zoom-in"),_=p.children(".zoom-out");if(n=s.panzoom({contain:"invert",minScale:1,$zoomIn:c,$zoomOut:_}),i){var m=void 0!==r.data("floor")&&null!==r.data("floor")?r.data("floor"):void 0;r.css("display","block"),e=(r.outerHeight()-s.outerHeight())/2,n.panzoom("setMatrix",[1,0,0,1,0,e]),r.css({visibility:"visible",opacity:"1",transition:"visibility 0s step-end, opacity .4s linear"}),p.css({opacity:"1",transition:"all .4s linear .4s"}),a('.map__pagination-link[data-floor="'+m+'"]').addClass("map__pagination-link--active"),o.location.hash=t}l.on("mousewheel.focal",function(a){a.preventDefault();var o=a.delta||a.originalEvent.wheelDelta,t=o?o<0:a.originalEvent.deltaY>0;n.panzoom("zoom",t,{animate:!1,focal:a})}),n.on("panzoomend",function(o,t,i,e){if(!e){var n,r=o.target,s=a(".shop_hover_group");a(".map-category__floor-list-link").removeClass("map-category__floor-list-link--active"),s.removeClass("shop_hover_group--active"),"shop_hover_group"==r.parentElement.classList[0]?n=r.parentElement.id:"text2"==r.classList.value?n=r.dataset.elem:"tspan"==r.tagName&&(n=r.parentElement.dataset.elem),a("#"+n).addClass("shop_hover_group--active"),a('.map-category__floor-list-link[data-area="'+n+'"]').addClass("map-category__floor-list-link--active"),showInstituionPopup(a("#"+n))}})}function n(){if(a(".map__pagination").outerHeight()<=a(".map__inner").outerHeight()&&o.innerWidth>=1024){var t=a(".map__inner").offset().top+(a(".map__inner").outerHeight()/2-a(".map__pagination").outerHeight()/2)+(a(".map__inner").offset().top-a(o).scrollTop());a(".map__pagination").css("top",t)}else a(".map__pagination").css("top","")}a(t).ready(function(){n()}),a(o).on("scroll",function(){n()}),a(o).on("resize",function(){if(n(),o.innerWidth>=1024&&a(".map-category").hasClass("map-category--active")){var t=a("html");a(".map-category").removeClass("map-category--active"),t.css("overflow","")}});var r=new URL(o.location.href),s=r.searchParams.get("area");if(void 0!==s&&null!==s&&""!==s){var l=s.split("_",1);a("#"+s).length&&(o.location.hash=l,a("#"+s).addClass("shop_hover_group--active"))}var p=void 0!==o.location.hash&&null!==o.location.hash&&""!==o.location.hash?o.location.hash:"#floor1",c=!0;a(o).scroll(function(){c&&(o.scrollTo(0,0),c=!1)});for(var _=0;_<a(".map__floor").length;_++){var m=a(".map__floor").eq(_),d=void 0!==m.attr("id")&&null!==m.attr("id")?"#"+m.attr("id"):void 0;p==d?e(d,!0):e(d,!1)}a("svg").on("mouseenter",".text2",function(o){var t=a(this),i=void 0!==t.data("elem")&&null!==t.data("elem")?t.data("elem"):void 0;a("#"+i).css("opacity","1")}).on("mouseleave",".text2",function(o){var t=a(this),i=void 0!==t.data("elem")&&null!==t.data("elem")?t.data("elem"):void 0;a("#"+i).css("opacity","")}).on("mouseover",".shop_hover_group",function(o){a(".text").find("*[data-elem="+a(this).attr("id")+"]").length||a("body").append('                    <div class="map__note">'+a(this).data("name")+"</div>                ")}).on("mouseout",".shop_hover_group",function(o){var t=a(".map__note");t.length&&t.remove()}).on("mousemove",function(o){var t=a(".map__note");if(t.length){var i=o.pageX-t.outerWidth()/2,e=o.pageY-t.outerHeight()-15;t.css({top:e,left:i})}}),a(".map__pagination").on("click",".map__pagination-link",function(t){t.preventDefault();var i=a(this),e=void 0!==i.attr("href")&&null!==i.attr("href")?i.attr("href"):void 0,n=a(".map__pagination-link--active"),r=void 0!==n.data("floor")&&null!==n.data("floor")?n.data("floor"):void 0,s=a("#floor"+r),l=void 0!==i.data("floor")&&null!==i.data("floor")?i.data("floor"):void 0;a(".map__pagination-link").removeClass("map__pagination-link--active"),i.addClass("map__pagination-link--active"),o.location.hash=e,r>l?(s.find(".map__controls").css({opacity:"",transition:""}),s.css({"z-index":"1",top:"-100px",opacity:"0",transform:"scale(1.3)",transition:""}),setTimeout(function(){s.css({"z-index":"",display:"",visibility:"",opacity:"",top:"",transform:"",transition:""})},400),a(e).css({display:"block"}),topPosition=(a(e).outerHeight()-a(e).find(".panzoom").outerHeight())/2,a(e).find(".panzoom").panzoom("setMatrix",[1,0,0,1,0,topPosition]),a(e).css({top:"100px",display:"block",transform:"scale(.7)",transition:"visibility 0s step-end, opacity 0s linear, top 0s linear, transform 0s linear"}),setTimeout(function(){a(e).css({top:"",visibility:"visible",opacity:"1",transform:"scale(1)",transition:"visibility 0s step-end, opacity .4s linear, top .4s linear, transform .4s linear"})},100),a(e).find(".map__controls").css({opacity:"1",transition:"all .4s linear .5s"})):r<l&&(s.find(".map__controls").css({opacity:"",transition:""}),s.css({top:"100px",opacity:"0",transform:"scale(0.7)",transition:""}),setTimeout(function(){s.css({display:"",visibility:"",opacity:"",top:"",transform:"",transition:""})},400),a(e).css({display:"block"}),topPosition=(a(e).outerHeight()-a(e).find(".panzoom").outerHeight())/2,a(e).find(".panzoom").panzoom("setMatrix",[1,0,0,1,0,topPosition]),a(e).css({"z-index":"1",top:"-100px",transform:"scale(1.3)",transition:"visibility 0s step-end, opacity 0s linear, top 0s linear, transform 0s linear"}),setTimeout(function(){a(e).css({top:"",visibility:"visible",opacity:"1",transform:"scale(1)",transition:"visibility 0s step-end, opacity .4s linear, top .4s linear, transform .4s linear"})},100),a(e).find(".map__controls").css({opacity:"1",transition:"all .4s linear .5s"}))}),a(".map-category").on("click",".map-category__menu-link",function(o){o.preventDefault();var t=a(this);t.next(".map-category__list").length?t.next(".map-category__list").is(":visible")?t.next(".map-category__list").slideUp():(a(".map-category__list:visible").slideUp(),a(".map-category__box:visible").removeClass("map-category__box--open"),a(".map-category__box").children(".map-category__drop").slideUp(200),t.next(".map-category__list").slideDown()):t.next(".map-category__box").length&&(t.next(".map-category__box").hasClass("map-category__box--open")?(t.next(".map-category__box").removeClass("map-category__box--open"),t.next(".map-category__box").children(".map-category__drop").slideUp(200)):(a(".map-category__box:visible").removeClass("map-category__box--open"),a(".map-category__box").children(".map-category__drop").slideUp(200),a(".map-category__list:visible").slideUp(),t.next(".map-category__box").addClass("map-category__box--open"),t.next(".map-category__box").children(".map-category__drop").slideDown(200)))}).on("click",".map-category__link",function(o){o.preventDefault();var t=a(this),i=t.parent().parent(".map-category__item"),e=t.next(".map-category__drop"),n=a(".map-category__drop");i.hasClass("map-category__item--active")||(a(".map-category__item").removeClass("map-category__item--active"),n.slideUp(200),i.addClass("map-category__item--active"),e.slideDown(200))}).on("click",".map-category__box-close",function(o){o.preventDefault();var t=a(this),i=t.parent().parent(".map-category__item"),e=t.next().next(".map-category__drop");i.removeClass("map-category__item--active"),e.slideUp(200)}).on("click",".map-category__floor-link",function(t){t.preventDefault();var i=a(this),e=i.next().children(".map-category__floor-list-item"),n=void 0!==i.data("floor")&&null!==i.data("floor")?"floor"+i.data("floor"):void 0,r=a(".shop_hover_group");if(a(".map-category__floor-list-link").removeClass("map-category__floor-list-link--active"),r.removeClass("shop_hover_group--active"),a('.map__pagination-link[href="#'+n+'"]').trigger("click"),e.each(function(){var o=a(this).children(".map-category__floor-list-link"),t=void 0!==o.data("area")&&null!==o.data("area")?o.data("area"):void 0;o.addClass("map-category__floor-list-link--active"),a("#"+t).addClass("shop_hover_group--active")}),o.innerWidth<1024){var s=a("html");a(".map-category").removeClass("map-category--active"),s.css("overflow","")}}).on("click",".map-category__floor-list-link",function(t){var i=a(this),e=void 0!==i.data("area")&&null!==i.data("area")?i.data("area"):void 0,n=e.split("_",1),r=a(".shop_hover_group");if(a(".map-category__floor-list-link").removeClass("map-category__floor-list-link--active"),r.removeClass("shop_hover_group--active"),i.addClass("map-category__floor-list-link--active"),a('.map__pagination-link[href="#'+n+'"]').trigger("click"),a("#"+e).addClass("shop_hover_group--active"),o.innerWidth<1024){var s=a("html");a(".map-category").removeClass("map-category--active"),s.css("overflow","")}}),a(".map").on("click",".map__button",function(o){o.preventDefault();var t=a("html"),i=a(".map-category");t.css("overflow","hidden"),i.addClass("map-category--active")}),a(".map-category").on("click",".map-category__close",function(o){o.preventDefault();var t=a("html");a(".map-category").removeClass("map-category--active"),t.css("overflow","")})}($,window,document);